<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xml:lang="en" lang="en">
<head>
<meta charset="utf-8"/>
<title>Molecular mechanics</title>
<link rel="stylesheet" href="../styles/stylesheet.css" type="text/css"/>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<section epub:type="chapter" id="ch03">
<a id="page_32" class="page" style="width:70%;">Page 32, Molecular mechanics</a>
<h1 class="main">3<span class="space">&#160;</span>Molecular mechanics</h1>
<p class="noindent">&#160;</p>
<section epub:type="chapter" id="sec_3.1">
<h2 class="h2">3.1<span class="space">&#160;</span>Introduction</h2>
<p class="noindent">The calculations outlined in the previous chapter, while offering a rigorous description of the molecule from both a structural and electronic point of view, suffer as a result of their computer requirements. The amount of computer time to do conformational analysis, including minimization, or to define a potential surface even for a small molecule, can be prohibitive in terms of both time and memory. When these problems are considered in tandem with the explosion of structural data in both the biological and materials fields, it is obvious that a different representation is required. In addition, it should be borne in mind that for many applications the detailed information supplied by the quantum mechanical calculation is of little interest, especially if only a molecular geometry is required. At all times one should be pragmatic as to which method would be the best for a given application.</p>
<p class="indent">Just as the 1960s witnessed an explosion in the application of quantum mechanical methods, there was a complementary interest in so-called &#x2018;force field&#x2019; methods for conformational analysis. The origin of these methods lies in vibrational spectroscopy, where the information derived from detailed analyses of vibrational spectra required the development of potential functions to describe the overall molecular behaviour. Two different approaches were considered. In the first, the Central Force Field (CFF) method, the molecular vibrations were fitted to a function which was a sum of pairwise interactions, without reference to the covalent structure of the molecule. The obvious disadvantage of this approach is that although such a description is correct in terms of a quantum mechanical model of a molecule, it lacks the intuitive link with structure with which chemists are more happy. The second method, the Valence Force Field (VFF), provides such a description in that the vibrational data is fitted to a potential function consisting of bond length and bond angle dependent terms. This is much more satisfactory and has the advantage of allowing comparisons between molecules; unlike the CFF potential functions which will be very molecule dependent. The major criticism of the VFF method is that the force constants produced must attempt to incorporate intramolecular interactions such as dispersion forces which result from electron correlation, and therefore are not simply a representation of the intrinsic vibrational frequency.</p>
<p class="indent">These spectroscopic force fields provided the ideal starting point for what is now called molecular mechanics. By bringing together features from both the CFF and VFF methods, it proved possible to derive energy functions which were at once chemically intuitive while still retaining the concept of through space attractions and repulsions.</p>
<a id="page_33" class="page" style="width:70%;">Page 33, Molecular mechanics</a>
<p class="indent">The theoretical basis of the molecular mechanics method can be derived by taking an alternative approach to the Born-Oppenheimer approximation to that considered in molecular orbital methods: in this case the nuclear motion is considered while implying a fixed electron distribution associated with each atom. To this end a model has been developed whereby a molecule is represented as a collection of spheres (possibly deformable) joined by springs. The motions of these atoms can then be described by the laws of classical physics and simple potential energy functions can be used. This allows much larger chemical systems (of the order of thousands of atoms) to be investigated.</p>
<p class="indent">Although this method of calculation sounds ideal, the following caveats must be kept in mind. First, as the method neglects explicit representation of electrons, it is restricted principally to the discussion of molecular ground states. This also disallows the investigation of reactions. Secondly, the results obtained will only be as good as the potential functions and parameters used; much of the potential surface defined by the force field has little validity as, typically, only extrema (stable conformations, rotational barriers etc.) are used in the parameterization procedure.</p>
</section>
<section epub:type="chapter" id="sec_3.2">
<h2 class="h2">3.2<span class="space">&#160;</span> The energy calculation</h2>
<p class="noindent">The molecular representation introduced in the previous section was one which treated molecules as a set of vibrating spheres. The next step is to define an energy function which is consistent with this concept yet allows accurate calculation of molecular properties. The force fields commonly encountered today have resulted from a number of generations of development. Typically, more structural and thermodynamic data have become available, coupled with considerable increases in computer power, allowing an extension of the functional form of the energy calculation. As more terms are included, the accuracy of the force field increases.</p>
<aside class="abc" style="margin-top:-4em;" epub:type="sidebar">
<figure class="fig1" id="fig3_1">
<img src="../images/fig3_1.jpg" alt="images"/>
</figure>
<p class="fcaption1"><b>Fig. 3.1</b>&#x00A0;&#x00A0;Pictorial representation of the terms included in a molecular mechanics force field.</p>
</aside>
<p class="indent">The energy of a molecule is calculated as a sum of the steric and non-bonded interactions present. Therefore each bond length, angle and dihedral is treated individually while non-bonded interactions represent the influence of non-covalent forces.</p>
<p class="fig1a" id="eq3.1"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msub><mi>E</mi><mrow><mtext>tot</mtext></mrow></msub><mo>=</mo><msub><mi>E</mi><mn>l</mn></msub><mo>+</mo><msub><mi>E</mi><mtext>&#x03B8;</mtext></msub><mo>+</mo><msub><mi>E</mi><mtext>&#x03C9;</mtext></msub><mo>+</mo><msub><mi>E</mi><mrow><mtext>nb</mtext></mrow></msub><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.1</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent">Here <i>E</i><sub>l</sub>, <i>E</i><sub>&#x03B8;</sub>, <i>E</i><sub>&#x03C9;</sub>, and <i>E</i><sub>nb</sub> are respectively the total bond, angle, dihedral and non-bonded energies. This is shown pictorially in <a href="#fig3_1">Fig. 3.1</a>.</p>
<section epub:type="chapter" id="sec_3.2.1">
<h3 class="h3">Bond stretch</h3>
<p class="noindent">The typical vibrational behaviour of a bond is near harmonic close to its equilibrium value but shows dissociation at longer bond lengths (<a href="#fig3_2">Fig. 3.2</a>). The most accurate description is the Morse function</p>
<p class="fig1a" id="eq3.2"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msub><mi>E</mi><mn>1</mn></msub><mo>=</mo><mo>&#x2211;</mo><msub><mtext>D</mtext><mtext>e</mtext></msub><msup><mrow><mo stretchy='false'>[</mo><mn>1</mn><mo>&#x2212;</mo><mi>exp</mi><mo>&#x007B;</mo><mo>&#x2212;</mo><mi>&#x03B1;</mi><mo stretchy='false'>(</mo><mi>l</mi><mo>&#x2212;</mo><msub><mi>l</mi><mn>0</mn></msub><mo stretchy='false'>)</mo><mo>&#x007D;</mo><mo stretchy='false'>]</mo></mrow><mn>2</mn></msup><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.2</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent"><a id="page_34" class="page">Page 34, Molecular mechanics</a>where <i>l</i><sub>0</sub> is the equilibrium bond length, <i>D</i><sub>e</sub> the dissociation energy, and &#x03B1; a force constant. However, the exponential calculation is computationally expensive therefore most force fields have adopted a simple harmonic function</p>
<p class="fig1a" id="eq3.3"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msub><mi>E</mi><mn>1</mn></msub><mo>=</mo><mo>&#x2211;</mo><msub><mi>k</mi><mn>1</mn></msub><msup><mrow><mo stretchy='false'>(</mo><mi>l</mi><mo>&#x2212;</mo><msub><mi>l</mi><mn>0</mn></msub><mo stretchy='false'>)</mo></mrow><mn>2</mn></msup><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.3</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent"><i>k</i><sub>l</sub> being the stretching force constant describing the deformation. The bond stretch is treated in the same fashion as a stretched spring. This equation has obvious limitations in that it only approximately describes the actual behaviour of the bond. Further, at extended bond lengths it is much too steep (see <a href="#fig3_2">Fig. 3.2</a>), while it provides no representation of dissociation at very large deformations. When discussing minimization of poor geometries we will see that this can be an advantage as this function can allow more extended bonds to remain intact.</p>
<aside class="abc" style="margin-top:-4em;" epub:type="sidebar">
<figure class="fig1" id="fig3_2">
<img src="../images/fig3_2.jpg" alt="images"/>
</figure>
<p class="fcaption1"><b>Fig. 3.2</b>&#x00A0;&#x00A0;Curves showing the variation of bond stretch energy with distance: - Morse potential; -harmonic potential.</p>
</aside>
<p class="indent">Other variations on <a href="#eq3.3">Eqn. 3.3</a> have been used to accommodate more accurate long distance behaviour. Most commonly this takes the form of an additional cubic term</p>
<p class="fig1a" id="eq3.4"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msub><mi>E</mi><mn>1</mn></msub><mo>=</mo><mo>&#x2211;</mo><msub><mi>k</mi><mn>1</mn></msub><msup><mrow><mo stretchy='false'>(</mo><mi>l</mi><mo>&#x2212;</mo><msub><mi>l</mi><mn>0</mn></msub><mo stretchy='false'>)</mo></mrow><mn>2</mn></msup><mo>+</mo><msub><msup><mi>k</mi><mo>&#x2032;</mo></msup><mn>1</mn></msub><msup><mrow><mo stretchy='false'>(</mo><mi>l</mi><mo>&#x2212;</mo><msub><mi>l</mi><mn>0</mn></msub><mo stretchy='false'>)</mo></mrow><mn>3</mn></msup><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.4</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent">but this suffers from the problem of inversion at long distances. Attempts have been made to remedy this by adding a quartic term which reverses the inversion.</p>
</section>
<section epub:type="chapter" id="sec_3.2.2">
<h3 class="h3">Bond angles</h3>
<p class="noindent">Historically, bond angles have been treated in the same way as bond lengths and are usually described by a harmonic function.</p>
<p class="fig1a" id="eq3.5"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msub><mi>E</mi><mtext>&#x03B8;</mtext></msub><mo>=</mo><mo>&#x2211;</mo><msub><mi>k</mi><mtext>&#x03B8;</mtext></msub><msup><mrow><mo stretchy='false'>(</mo><mtext>&#x03B8;</mtext><mo>&#x2212;</mo><msub><mtext>&#x03B8;</mtext><mn>0</mn></msub><mo stretchy='false'>)</mo></mrow><mn>2</mn></msup><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.5</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent">As before, <i>k</i><sub>&#x03B8;</sub> is a force constant and &#x03B8;<sub>0</sub> the equilibrium value for the bond angle. Again, this term is not ideal for the full range of values observed so higher order terms must be added. In very strained ring systems, however, it is usually not possible to use the constants derived for unstrained and acyclic molecules so separate three- and four-membered ring constants have been developed.</p>
</section>
<section epub:type="chapter" id="sec_3.2.3">
<h3 class="h3">Dihedral angles</h3>
<p class="indent">In very early force fields it was thought that this term could be omitted; gauche-trans energy differences would then result from non-bonded interactions. This soon proved to be an impossible task and dihedral angle terms were explicitly included. The functional form of this term is a Fourier series</p>
<p class="fig1a" id="eq3.6"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msub><mi>E</mi><mi>&#x03C9;</mi></msub><mo>=</mo><mo>&#x2211;</mo><msub><mi>V</mi><mtext>n</mtext></msub><mo stretchy='false'>(</mo><mn>1</mn><mo>+</mo><mi>s</mi><mtext>&#x2009;</mtext><mi>c</mi><mi>o</mi><mi>s</mi><mtext>&#x2009;</mtext><mi>n</mi><mi>&#x03C9;</mi><mo stretchy='false'>)</mo><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.6</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent"><a id="page_35" class="page">Page 35, Molecular mechanics</a>where <i>V</i><sub>n</sub> is the rotational barrier height, n the periodicity of rotation (e.g. in ethane n = 3; in ethene n = 2) and <i>s</i> = 1 for staggered minima and &#x2212;1 for eclipsed minima. <a href="#fig3_3">Fig. 3.3</a> shows the n = 1, 2 and 3 curves.</p>
<aside class="abc" style="margin-top:-4em;" epub:type="sidebar">
<figure class="fig1" id="fig3_3">
<img src="../images/fig3_3.jpg" alt="images"/>
</figure>
<p class="fcaption1"><b>Fig. 3.3</b>&#x00A0;&#x00A0;Variation of energy with dihedral angle for one-(&#x2026;), two-(--) and threefold (-) barriers.</p>
</aside>
<p class="indent">In the simple molecules above, a single term, summed over all interactions, would suffice, but as the symmetry across the rotatable bond breaks down, the complexity of the energy profile increases. These can be corrected by the inclusion of other Fourier terms. Consider butane as 1,2-dimethyl ethane. Obviously the eclipsing interaction of the two methyl substituents will be higher in energy than that between one methyl and one hydrogen, or between two hydrogens. Increasing the size of the C-C-C-C three-fold barrier (<i>V</i><sub>3</sub>) would artificially modify the energy of the other eclipsing interactions. Modifying the interaction by the inclusion of a onefold term (since the methyl-methyl eclipse occurs only once per 360&#x00B0; rotation) is the only option available. By way of warning, it should also be noted that the <i>V</i><sub>n</sub> parameters do not represent the complete rotational barrier but that van der Waals interactions must also be taken into account.</p>
</section>
<section epub:type="chapter" id="sec_3.2.4">
<h3 class="h3" style="margin-top:2em;">Non-bonded interactions</h3>
<p class="noindent">The interactions discussed in the previous sections can also be grouped together as the bonded interactions, in the sense that they are defined by the connectivity of the molecule. The non-bonded interactions, on the other hand, are distance-dependent and are calculated as the sum over all atoms with a 1,4 or greater separation. It is usual to consider these interactions as having two components: van der Waals and electrostatic. The former can be considered as both a size parameter and representative of electron correlation (resulting from instantaneous dipole interactions), while the latter provides a quantitative measurement of the influence of polarity on the energy and structure.</p>
<p class="indent">Many different functional forms have been used for van der Waals interactions but the most common is the so-called 6&#x2013;12, or Lennard-Jones potential</p>
<p class="fig1a" id="eq3.7"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msub><mi>E</mi><mrow><mtext>vdw</mtext></mrow></msub><mo>=</mo><mo>&#x2211;</mo><mtext>&#x03B5;</mtext><mo stretchy='false'>[</mo><msup><mrow><mo stretchy='false'>(</mo><msub><mi>r</mi><mtext>m</mtext></msub><mo>/</mo><mi>r</mi><mo stretchy='false'>)</mo></mrow><mrow><mn>12</mn></mrow></msup><mo>&#x2212;</mo><mn>2</mn><msup><mrow><mo stretchy='false'>(</mo><msub><mi>r</mi><mtext>m</mtext></msub><mo>/</mo><mi>r</mi><mo stretchy='false'>)</mo></mrow><mn>6</mn></msup><mo stretchy='false'>]</mo><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.7</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent">&#x03B5; is the well depth and <i>r</i><sub>m</sub> is the minimum energy interaction distance (<a href="#fig3_4">Fig. 3.4</a>). Short range repulsions are accounted for by the <i>r</i><sup>&#x2212;12</sup> term whereas London dispersion-attraction forces are mediated by the <i>r</i><sup>&#x2212;6</sup> component. At short distances the repulsive term dominates. The theoretical validity of this function is discussed in most physical chemistry textbooks.</p>
<p class="indent">Other forms have been proposed for the van der Waals interaction, principally because the <i>r</i><sup>&#x2212;12</sup> term can be too steep at just less than optimal distances; these short contacts can be important when investigating sterically crowded structures. In the Buckingham potential</p>
<p class="fig1a" id="eq3.8"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msub><mi>E</mi><mrow><mtext>vdw</mtext></mrow></msub><mo>=</mo><mi>A</mi><mi>exp</mi><mo stretchy='false'>(</mo><mo>&#x2212;</mo><mi>B</mi><mi>r</mi><mo stretchy='false'>)</mo><mo>&#x2212;</mo><mi>C</mi><msup><mi>r</mi><mrow><mo>&#x2212;</mo><mn>6</mn></mrow></msup><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.8</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent">an exponential replaces the repulsive <i>r</i><sup>&#x2212;12</sup> term. In most circumstances this function behaves similarly to the Lennard-Jones equation but at very short <a id="page_36" class="page">Page 36, Molecular mechanics</a>interatomic distances the function inverts and goes to <b>&#x2212;&#x221E;</b>, an obvious danger in poorly constructed model structures.</p>
<p class="indent">The choice of function has tended to be driven by computing requirements. For a small molecule the number of interactions is relatively small and the close range behaviour is crucial. In this situation the overhead involved in calculating <i>r</i>, as opposed to <i>r</i><sup>2</sup>, and the exponential is not that high. For a protein the number of interactions is considerably higher, but the contacts are likely to be close to equilibrium values. Using the Lennard-Jones function avoids the calculation of large numbers of square roots and exponentials (<i>r</i><sup>&#x2212;6</sup> can be calculated from <i>r</i><sup>2</sup>). The 6&#x2013;12 function also has the added advantage of requiring fewer parameters.</p>
<aside class="abc" style="margin-top:-4em;" epub:type="sidebar">
<figure class="fig1" id="fig3_4">
<img src="../images/fig3_4.jpg" alt="images"/>
</figure>
<p class="fcaption1"><b>Fig. 3.4</b>&#x00A0;&#x00A0;A typical van der Waals curve.</p>
</aside>
<p class="indent">The second component of the non-bonded potential is the electrostatic term. This is usually calculated using partial charges <i>(q)</i> on the atom centres with the energy calculated using Coulomb&#x2019;s law</p>
<p class="fig1a" id="eq3.9"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msub><mi>E</mi><mrow><mtext>el</mtext></mrow></msub><mo>=</mo><mo>&#x2211;</mo><msub><mi>q</mi><mtext>i</mtext></msub><msub><mi>q</mi><mtext>j</mtext></msub><mo>/</mo><mi>D</mi><msub><mi>r</mi><mrow><mtext>ij</mtext></mrow></msub><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.9</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent">with the dielectric constant <i>D</i> taking a value appropriate to a given solvent or made proportional to the distance <i>r</i><sub>ij</sub> between the charges. The electrostatic contribution is one of the most controversial in molecular mechanics and will be discussed further as part of the parameterization procedure.</p>
</section>
<section epub:type="chapter" id="sec_3.2.5">
<h3 class="h3">Other terms</h3>
<p class="noindent">The five terms outlined above constitute the core of almost all molecular mechanics force fields; in some case the entire energy function. In many situations, however, it is necessary for additional terms to be included.</p>
<p class="indent">For systems where hydrogen bonding is vital for stability, e.g. biological molecules, it has been common to include an additional, explicit hydrogen bond energy function to ensure correct geometries. In certain protein force fields this takes the form</p>
<p class="fig1a" id="eq3.10"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msub><mi>E</mi><mrow><mtext>hb</mtext></mrow></msub><mo>=</mo><mo>&#x2211;</mo><mo stretchy='false'>(</mo><msub><mi>C</mi><mrow><mtext>ij</mtext></mrow></msub><mo>/</mo><msubsup><mi>r</mi><mrow><mi>i</mi><mtext>j</mtext></mrow><mrow><mn>12</mn></mrow></msubsup><mo stretchy='false'>)</mo><mo>&#x2212;</mo><mo stretchy='false'>(</mo><msub><mi>E</mi><mrow><mtext>ij</mtext></mrow></msub><mo>/</mo><msubsup><mi>r</mi><mrow><mtext>ij</mtext></mrow><mrow><mn>10</mn></mrow></msubsup><mo stretchy='false'>)</mo><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.10</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent">Other force fields attempt to simulate hydrogen bonds using just the van der Waals and electrostatic terms without the inclusion of a special attractive potential. This latter method could well be the more valid as, in an attempt to retain optimum hydrogen bonding geometries, the explicit function might give correct configurations at the expense of creating strain elsewhere.</p>
<p class="indent">A second problem which can arise is restricting the planarity of isolated unsaturated centres. The four atoms in this grouping should be kept in a plane, however, the branch atom &#x2013; e.g., in the case carbonyl groups, the oxygen &#x2013; can be distorted. If the distortion is measured as the height of the central atom above the plane formed by the other three atoms then a simple restraining force can be used to hold the group in its correct geometry.</p>
<p class="fig1a" id="eq3.11"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msub><mi>E</mi><mrow><mtext>opl</mtext></mrow></msub><mo>=</mo><mo>&#x2211;</mo><msub><mi>k</mi><mi>x</mi></msub><msup><mi>x</mi><mn>2</mn></msup><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.11</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent"><a id="page_37" class="page">Page 37, Molecular mechanics</a>where <i>k</i><sub>&#x03C7;</sub> is the force constant and &#x03C7; the height above the plane. A modified version of this type of function can also be used as a chirality constraint.</p>
<p class="indent">Thus far, all of the potential functions have been concerned with isolated features of molecules. If any structural changes are correlated then, in this type of force field, they must result from a combination of appropriate forces. If only structural and thermodynamic data are required to be reproduced, this form of the force field (the so-called second generation) is adequate. However, to fit, in addition, vibrational frequencies, the coupling between geometric features must be explicitly included in the representation of the molecule.</p>
<p class="indent">If one considers the structure of butane (<a href="#fig3_5">Fig. 3.5</a>) it is clear that as the conformation changes from <i>anti</i> to <i>syn</i> there is a change in the C-C bond length and an opening of the C-C-C bond angles. The best way to incorporate this kind of feature into the force field is <i>via</i> a stretch-bend interaction. This has the effect of restraining distortion of the angle through compensatory bond stretches. A potential term of this type allows greater transferability of the isolated bond angle terms which, if fitted to butane data, would otherwise give poor ethane geometries.</p>
<aside class="abc" style="margin-top:-2em;" epub:type="sidebar">
<figure class="fig1" id="fig3_5">
<img src="../images/fig3_5.jpg" alt="images"/>
</figure>
<p class="fcaption1"><b>Fig. 3.5</b>&#x00A0;&#x00A0;Molecular geometries for syn and anti butane structures.</p>
</aside>
<p class="indent">Other commonly used cross terms include bend-bend and torsion-bend. The functional forms are as follows:</p>
<p class="noindent">stretch-bend</p>
<p class="fig1a" id="eq3.12"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msub><mi>E</mi><mrow><mi>l</mi><mi>&#x03B8;</mi></mrow></msub><mo>=</mo><mo>&#x2211;</mo><mo>&#x2211;</mo><msub><mtext>k</mtext><mrow><mi>l</mi><mi>&#x03B8;</mi></mrow></msub><mo stretchy='false'>(</mo><mi>l</mi><mo>&#x2212;</mo><msub><mi>l</mi><mn>0</mn></msub><mo stretchy='false'>)</mo><mo stretchy='false'>(</mo><mi>&#x03B8;</mi><mo>&#x2212;</mo><msub><mi>&#x03B8;</mi><mn>0</mn></msub><mo stretchy='false'>)</mo><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.13</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent">bend-bend</p>
<p class="fig1a" id="eq3.13"><math xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mi>E</mi><mrow><mi>&#x03B8;</mi><msup><mi>&#x03B8;</mi><mo>&#x2032;</mo></msup></mrow></msub><mo>=</mo><msup><mstyle mathsize='140%' displaystyle='true'><mo>&#x2211;</mo></mstyle><mtext>&#x200B;</mtext></msup><msub><mtext>k</mtext><mrow><mi>&#x03B8;</mi><msup><mi>&#x03B8;</mi><mo>&#x2032;</mo></msup><mi>&#x03C9;</mi></mrow></msub><mo stretchy='false'>(</mo><mi>&#x03B8;</mi><mo>&#x2212;</mo><msub><mi>&#x03B8;</mi><mn>0</mn></msub><mo stretchy='false'>)</mo><mo stretchy='false'>(</mo><msup><mi>&#x03B8;</mi><mo>&#x2032;</mo></msup><mo>&#x2212;</mo><msub><msup><mi>&#x03B8;</mi><mo>&#x2032;</mo></msup><mn>0</mn></msub><mo stretchy='false'>)</mo><mi>cos</mi><mi>&#x03C9;</mi><mtext>&#x2009;</mtext><mtext>&#x2009;</mtext><mtext>&#x2009;</mtext><mtext>&#x2009;</mtext><mo stretchy='false'>(</mo><mn>3.14</mn><mo stretchy='false'>)</mo></mrow></math></p>
<p class="noindent">torsion-bend</p>
<p class="fig1a" id="eq3.14"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msub><mi>E</mi><mrow><mi>&#x03B8;</mi><msup><mi>&#x03B8;</mi><mo>&#x2032;</mo></msup><mi>&#x03C9;</mi></mrow></msub><mo>=</mo><mstyle displaystyle='true'><mo>&#x2211;</mo> <mrow><msub><mtext>k</mtext><mrow><mi>&#x03B8;</mi><msup><mi>&#x03B8;</mi><mo>&#x2032;</mo></msup><mi>&#x03C9;</mi></mrow></msub><mo stretchy='false'>(</mo><mi>&#x03B8;</mi><mo>&#x2212;</mo><msub><mi>&#x03B8;</mi><mn>0</mn></msub><mo stretchy='false'>)</mo><mo stretchy='false'>(</mo><msup><mi>&#x03B8;</mi><mo>&#x2032;</mo></msup><mo>&#x2212;</mo><msub><msup><mi>&#x03B8;</mi><mo>&#x2032;</mo></msup><mn>0</mn></msub><mo stretchy='false'>)</mo></mrow></mstyle><mi>cos</mi><mi>&#x03C9;</mi><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.14</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent">where the <i>k</i> terms are the force constants; <i>l</i>, <i>l</i><sub>o,</sub> &#x03B8;, &#x03B8;<sub>o</sub> and <i>&#x03C9;</i> are as before.</p>
<p class="indent">A force field including all of the valence, non-bonded and cross terms can be parameterized to give very close agreement with experiment for a large syn and antf butane structures, number of properties. Problems may occur, however, when highly polarizable groups or ions are present. In this situation the static charge distribution assumed in the electrostatic term is no longer realistic or adequate and an additional polarization potential will be required. Also, the van der Waals potential assumed strict pairwise interactions but more complex, many-body terms might also come into play. Attempts to include these effects are still at an experimental stage and no simple representation can be prescribed.</p>
<p class="indent">The final situation to be considered is the presence of delocalised &#x03C0; systems. This does not have any bearing on protein and other biological systems as the &#x03C0; systems are isolated from other unsaturated regions, e.g. aromatic amino-acids and DNA bases. This allows the use of large twofold barrier constants which will resist deformation out of the plane without interfering with the conformational mobility of other regions of the molecule. For many small, unsaturated molecules, and systems based upon porphyrins, this is not possible, unless one creates a new set of atom types for every instance. Here, some account must be taken of the degree of partial <a id="page_38" class="page">Page 38, Molecular mechanics</a>double-bond character and this should be allowed to vary according to structural changes. An elegant way of getting around this problem has been implemented in the MM2P program. The molecule in question is divided into conjugated segments and a simple SCF scheme is used to calculate bond orders about this fragment. These bond orders allow new bending, stretching, and torsional parameters to be calculated which are sensitive to the degree of local &#x03C0; character at any given atom. In the simplest case the parameters vary linearly with bond order. A cosine dependence can also be used for the torsion angles indicating the degree of <i>p</i> orbital overlap. As the structure is optimized the parameters for the &#x03C0; system can be recalculated if the geometry changes beyond a certain tolerance.</p>
</section>
</section>
<section epub:type="chapter" id="sec_3.3">
<h2 class="h2">3.3<span class="space">&#160;</span>Energy minimization</h2>
<p class="noindent">If one has generated a model using molecular graphics, based upon standard molecular fragments, or from a z-matrix of typical internal coordinates, the energy obtained from the molecular mechanics calculation is likely to be high and not representative of the actual structure. To obtain more reliable geometries and energies one must attempt to minimize the energy of the system. This problem can be approached in two ways: either one can vary the actual internal coordinates to find their optimum value, or, as is more common, work in Cartesian coordinate space and optimize the atomic positions subject to the restraining forces generated by the molecular force field. Since most minimization methods require first, and sometimes second, derivatives of the energy the latter method is more convenient and the potential functions are easily differentiated.</p>
<p class="indent">A second issue which must be addressed is local versus global minimization. Given that there are three degrees of freedom per atom, for a molecule of N atoms there are 3N-6 variables to be minimized (subtracting those due to rotation and translation). A multi-dimensional problem of this nature is further complicated by the presence of many local energy troughs on the potential surface which are minima in a mathematical sense, however, they are higher in energy than the lowest energy state, or global minimum. This situation manifests itself even in the simple rotational potential for a 1,2-di-substituted ethane (<a href="#fig3_6">Fig. 3.6</a>). Clearly the gauche (&#x03C9; = 60&#x00B0;) conformation is stable but the molecule&#x2019;s preference would be for the trans conformation. This almost trivial example highlights perhaps one of the most difficult problems in computational chemistry: how does one find the global minimum (and how can one be certain that it is, in fact, the lowest energy structure).</p>
<aside class="abc" style="margin-top:-13em;" epub:type="sidebar">
<figure class="fig1" id="fig3_6">
<img src="../images/fig3_6.jpg" alt="images"/>
</figure>
<p class="fcaption1"><b>Fig. 3.6</b>&#x00A0;&#x00A0;Shape of the general rotational potential for 1,2-disubstituted ethanas.</p>
</aside>
<p class="indent">Many of the minimization programs currently in use today are based upon the mathematical principles of the Newton-Raphson method. This requires first and second derivative information about the energy surface, but a family of algorithms exist which use different approximations to the second derivative matrix (the Hessian).</p>
<p class="indent">An important property of the functions used for force field calculations is that they are continuous and differentiable. From simple calculus we know <a id="page_39" class="page">Page 39, Molecular mechanics</a>that the condition for a minimum on a curve, the point <i>x</i><sub>*</sub>, is that the first derivative equals zero, i.e.</p>
<p class="fig1a" id="eq3.15"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msup><mi>f</mi><mo>&#x2032;</mo></msup><mo stretchy='false'>(</mo><msup><mi>x</mi><mo>*</mo></msup><mo stretchy='false'>)</mo><mo>=</mo><mn>0</mn><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.15</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent">Since our starting point is <i>&#x03C7;</i> and not the minimum <i>&#x03C7;</i><sub>*</sub> we can write</p>
<p class="fig1a" id="eq3.16"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msup><mi>x</mi><mo>*</mo></msup><mo>=</mo><mi>x</mi><mo>+</mo><mi>&#x03B4;</mi><mi>x</mi><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.16</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent">where &#x03B4;<i>&#x03C7;</i> represents the changes which <i>&#x03C7;</i> must undergo to reach the minimum value. The condition for the minimum can therefore be written in terms of <i>&#x03C7;</i></p>
<p class="fig1a" id="eq3.17"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msup><mi>f</mi><mo>&#x2032;</mo></msup><mo stretchy='false'>(</mo><mi>x</mi><mo>+</mo><mi>&#x03B4;</mi><mi>x</mi><mo stretchy='false'>)</mo><mo>=</mo><mn>0</mn><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.17</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent">and expanded as a Taylor series</p>
<p class="fig1a" id="eq3.18"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msup><mi>f</mi><mo>&#x2032;</mo></msup><mo stretchy='false'>(</mo><mi>x</mi><mo>+</mo><mi>&#x03B4;</mi><mi>x</mi><mo stretchy='false'>)</mo><mo>=</mo><msup><mi>f</mi><mo>&#x2032;</mo></msup><mo stretchy='false'>(</mo><mi>x</mi><mo stretchy='false'>)</mo><mo>+</mo><msup><mi>f</mi><mo>&#x2033;</mo></msup><mo stretchy='false'>(</mo><mi>x</mi><mo stretchy='false'>)</mo><mi>&#x03B4;</mi><mi>x</mi><mo>+</mo><msup><mi>f</mi><mo>&#x2034;</mo></msup><mo stretchy='false'>(</mo><mi>x</mi><mo stretchy='false'>)</mo><mi>&#x03B4;</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>...</mn><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.18</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent">which is also set equal to zero. Truncating the Taylor series after the second order term gives</p>
<p class="fig1a" id="eq3.19"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msup><mi>f</mi><mo>&#x2032;</mo></msup><mo stretchy='false'>(</mo><mi>x</mi><mo stretchy='false'>)</mo><mo>+</mo><msup><mi>f</mi><mo>&#x2033;</mo></msup><mo stretchy='false'>(</mo><mi>x</mi><mo stretchy='false'>)</mo><mi>&#x03B4;</mi><mi>x</mi><mo>=</mo><mtext>&#x2009;</mtext><mn>0</mn><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.19</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent">Rearranging <a href="#eq3.19">Eqn. 3.19</a> gives the expression for the change which must be made to <i>&#x03C7;</i> to reach the minimum</p>
<p class="fig1a" id="eq3.20"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><mi>&#x03B4;</mi><mi>x</mi><mo>=</mo><mi>x</mi><mo>&#x2212;</mo><msup><mi>f</mi><mo>&#x2032;</mo></msup><mo stretchy='false'>(</mo><mi>x</mi><mo stretchy='false'>)</mo><mo>/</mo><msup><mi>f</mi><mo>&#x2033;</mo></msup><mo stretchy='false'>(</mo><mi>x</mi><mo stretchy='false'>)</mo><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.20</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent">which can be substituted back into 3.16 to give</p>
<p class="fig1a" id="eq3.21"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msup><mi>x</mi><mo>*</mo></msup><mo>=</mo><mi>x</mi><mo>&#x2212;</mo><msup><mi>f</mi><mo>&#x2032;</mo></msup><mo stretchy='false'>(</mo><mi>x</mi><mo stretchy='false'>)</mo><mo>/</mo><msup><mi>f</mi><mo>&#x2033;</mo></msup><mo stretchy='false'>(</mo><mi>x</mi><mo stretchy='false'>)</mo><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.21</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent">This is the simple one dimensional case. When considering molecules, each atom has three degrees of freedom &#x2013; in <i>x, y</i> and <i>z</i> &#x2013; and the term <i>f&#x0027;(x)</i> must be replaced by a 3N &#x03C7; 1 matrix <b>(F)</b> containing terms <i>&#x03B4;&#x03BD;/&#x03B4;&#x03C7;</i><sub>i</sub>, the derivatives of the potential energy (<i>V</i>) with respect to a change in coordinate i. The corresponding second derivative matrix is constructed using all the cross-derivative terms (&#x03B4;<sup>2</sup><i>&#x03BD;</i>/&#x03B4;<i>&#x03C7;</i><sub>i</sub>&#x03B4;<i>&#x03C7;</i><sub>j</sub> involving each coordinate. Since matrices have replaced the single values in <a href="#eq3.21">Eqn. 3.21</a>, it is no longer possible to carry out the simple division. Fortunately standard computational procedures exist to derive the inverse of the Hessian matrix and the second term in <a href="#eq3.21">Eqn. 3.21</a> can be replaced by <b>H<sup>&#x2212;1</sup>F</b>. Here <b>H<sup>&#x2212;1</sup></b> represents the inverse of the Hessian.</p>
<p class="indent">It should be noted that by truncating the Taylor series the assumption is made that the minimum is exactly quadratic in behaviour. For a complex surface this will not hold true far from the minimum but will be a better approximation as it moves closer. This forces the calculation to be carried out in a stepwise, iterative fashion, rather than reaching the minimum first time.</p>
<p class="indent">When working with small molecules (&#x003C;100 atoms) this approach is efficient and will converge after relatively few steps. As the number of atoms is increased, the number of matrix elements in the Hessian goes up rapidly <a id="page_40" class="page">Page 40, Molecular mechanics</a>making the calculation much slower. Additional problems with computer memory requirements for the storage of the Hessian may also be a severe limitation. This has necessitated the application of less efficient, but more practical algorithms, usually through an approximation of the Hessian. These include neglecting off-diagonal interactions between atoms (block diagonal Newton-Raphson), and the diagonal Newton-Raphson method which only calculates &#x03B4;<sup>2</sup><i>V</i>/&#x03B4;<i>&#x03C7;</i><sup>2</sup> values, neglecting correlation between the three degrees of freedom for a given atom.</p>
<p class="indent">A much more severe approximation to the Hessian is to consider it as a constant. This produces the steepest descent method which is driven purely by force gradients along the potential surface. If one imagines the energy surface as being rather like a hilly landscape then the most reliable way to find a valley, or energy well, is to follow the gradient downhill. As the gradient method has no information about the local curvature of the energy surface, minimization by this method slows down considerably as the gradient decreases. Close to the bottom of the potential well the energy differences can be rather small, however, the forces acting on the molecule can still be relatively large compared to those obtained by a less approximate method. The principal advantage of the steepest descent method is that it is very efficient when very large forces are present, far from a minimum, making it a robust choice to tidy up model geometries prior to further refinement by another method.</p>
<p class="indent">It is possible to exert more control in first derivative methods by including some kind of history of the minimization path. In pattern search methods the previous step is used to accelerate movement if the gradient is in the same direction as before. If the gradient changes, the pattern is abandoned and a new one set up.</p>
<p class="indent">A more elegant improvement to this method is that of conjugate gradients which, like pattern search, uses information from previous steps to modify the move in the next step. Unlike pattern search, it does not abandon the history if the direction changes. In the first step, where the gradient vector is <b>g</b><sub>l</sub> the move is given by</p>
<p class="fig1a" id="eq3.22"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msub><mtext>s</mtext><mn>1</mn></msub><mo>=</mo><mo>&#x2212;</mo><msub><mtext>g</mtext><mn>1</mn></msub><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.22</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent">The new direction from this step takes into account the previous gradient and follows the search direction</p>
<p class="fig1a" id="eq3.23"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msub><mtext>s</mtext><mtext>k</mtext></msub><mo>=</mo><mo>&#x2212;</mo><msub><mtext>g</mtext><mtext>k</mtext></msub><mo>+</mo><msub><mtext>b</mtext><mtext>k</mtext></msub><msub><mtext>s</mtext><mrow><mtext>k</mtext><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.23</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent">where <b>s</b><sub>k&#x2212;1</sub>, is the search direction from the previous step and <b>b<sub>k</sub></b> is a scaling factor given by</p>
<p class="indent"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><msub><mstyle mathvariant='bold' mathsize='normal'><mi>b</mi></mstyle><mtext>k</mtext></msub><mo>=</mo><msub><mtext>g</mtext><mrow><mtext>i</mtext><mo>+</mo><mn>1</mn></mrow></msub><mo>&#x00B7;</mo><msub><mi>g</mi><mrow><mtext>i</mtext><mo>+</mo><mn>1</mn></mrow></msub><mo>/</mo><msub><mtext>g</mtext><mtext>i</mtext></msub><mo>&#x00B7;</mo><msub><mtext>g</mtext><mtext>i</mtext></msub></mrow>
</semantics></math></p>
<p class="noindent">The effect of the second term in <a href="#eq3.23">Eqn. 3.23</a> is to release the constraint that the i+l<sup>th</sup> gradient should be orthogonal to the i<sup>th</sup> gradient. Hence, better search <a id="page_41" class="page">Page 41, Molecular mechanics</a>directions are usually obtained by this method than by steepest descents and it has much better convergence properties (<a href="#fig3_7">Fig. 3.7</a>).</p>
<p class="indent">In addition to its speed and memory requirements, the conjugate gradients method has the additional advantage that it is unlikely to maximize rather than minimize. This is one of the shortcomings of the Newton-Raphson family of methods which use only derivative information to search for stationary points: this could be either a maximum or a minimum. If a maximum on the energy surface is close to the starting point it is likely that it will be found, and a transition state structure will be obtained rather than a stable ground state.</p>
<p class="indent">In conclusion, the choice of minimizer should be tempered by the state of the starting structure: if it is a model, far from a minimum, then a method such as steepest descents should be applied. Once a low energy has been obtained it is advisable to switch to a method with better convergence properties &#x2013; some variant of the Newton-Raphson method or conjugate gradients &#x2013; which will have greater success in actually finding the minimum. Applying Newton-Raphson methods to poor structures could lead to catastrophic results, including maximized structures.</p>
<aside class="abc" style="margin-top:-8em;" epub:type="sidebar">
<figure class="fig1" id="fig3_7">
<img src="../images/fig3_7.jpg" alt="images"/>
</figure>
<p class="fcaption1"><b>Fig. 3.7</b>&#x00A0;&#x00A0;Minimization paths for a simple energy surface: &#x2014; steepest descent; -- conjugate gradients.</p>
</aside>
</section>
<section epub:type="chapter" id="sec_3.4">
<h2 class="h2">3.4<span class="space">&#160;</span>Force field parameterization</h2>
<p class="noindent">It is obvious that the quality of a given force field depends crucially on the parameters which are derived as constants in the potential function. Just as a given application can dictate which functional form is the most appropriate, the parameterization procedure must include this data when developing force constants and equilibrium values, in order to be valid. This can be both a strength and weakness of the force field method; the predictive ability of the method cannot easily extend beyond certain predetermined bounds, while within these limits the results can be very good indeed.</p>
<p class="indent">When discussing the different terms incorporated into the energy function, force fields were referred to as second or third generation. This reflects both the functional form of the potential equation and the scope of the data used in the fitting procedure. Available computer power must be considered as a vital factor in this historical division; obviously some kind of balance must be met between accuracy of calculation and time taken. Another consideration is the types of application of the force field. In the 1970s the principal interest was structure, which can be quite well described by the simple potential forms. More recently, interest has shifted to the dynamic behaviour of molecules. No longer is our interest restricted to the minima on the energy surface and this requires better defined descriptions between the extrema. Only by using complex energy functions which incorporate correlation between internal coordinates has this improvement be achieved.</p>
<aside class="abc" style="margin-top:-15em;" epub:type="sidebar">
<p class="noindent2">The development of the MM3 force field, a third generation potential, is discussed in Allinger, N. L., Yuh, Y. H., and Lii, J.-H. (1989). <i>J. Amer. Chem. Soc.,</i> <b>111</b>, 8551&#x2013;8566.</p>
</aside>
<p class="indent">A parameterization can be approached from two directions. One can attempt to automate the procedure and use least-squares optimization methods to obtain a simultaneous best fit of calculated results to experimental data. Like all multi-dimensional problems, local minimization is a hazard leading to mathematical solutions which have little physical <a id="page_42" class="page">Page 42, Molecular mechanics</a>significance. Optimization in this way must be closely watched to avoid excessive bias towards some parameters at the expense of others.</p>
<p class="indent">Alternatively, a trial and error procedure can be used. Here the user makes small changes to the parameters in an attempt to achieve the best possible fit. One advantage of this constant intervention is that a greater feel is obtained for the inter-relationships between parameters. In combination with a limited least-squares optimization better results should be possible than by the completely automated method.</p>
<p class="indent">As stated earlier, the data to be fitted should reflect the kind of applications for which the program will be used. For small molecules the most reliable source of data on geometries is gas phase structural studies, usually microwave or electron diffraction. The use of solution phase or crystal geometries is to be avoided as the influence of the environment is an unknown factor. Spectroscopic data can also provide information on rotational barriers and vibrational frequencies. Thermodynamic data such as heats of formation can also be included, but group contributions to &#x0394;<i>H</i><sub>f</sub> must also be derived. Data from <i>ab initio</i> molecular orbital calculations can also provide target values if few experimental data are available. More recently, the latter method has been extended. <i>Ab initio</i> molecular energy surfaces are calculated for typical molecules using basis sets of reliable quality. Rather than using equilibrium geometries, these surfaces and their first and second derivatives have been evaluated for a collection of geometries distorted along the normal modes of vibration. These surfaces now describe not just minimum energy positions but give a more accurate representation of the complete potential energy surface. By fitting a potential energy function and its derivatives to this kind of data one can be sure that energies of non-minimum energy structures are considered as &#x2018;real&#x2019; behaviour. The obvious limitation of this approach is that the surface is only as good as the <i>ab initio</i> calculations used in its derivation, but with enough computer time this ceases to be a problem. The main problem remaining is that the attractive part of a van der Waals function is not amenable to calculations at the Hartree-Fock limit.</p>
<p class="indent">The next issue is the origin of the starting values for each of the parameters. The important thing which must be remembered is that the resultant geometries come from the total interactions of the force field and not simply the force constant and equilibrium values for a given internal coordinate. This has the serious disadvantage that it is not strictly correct to place physical significance on the components of a force field generated energy. However, this allows greater flexibility in fitting the experimental data as the equilibrium values (<i>l</i><sub>o</sub>, &#x03B8;<sub>o</sub> etc.) become additional variable parameters.</p>
<aside class="abc" style="margin-top:-10em;" epub:type="sidebar">
<p class="noindent2">For more details on using <i>ab initio</i> surfaces to generate parameters see Maple, J., Dinur, U., and Hagler, A. T. (1989). <i>Proc. Natl. Acad. Sci., USA</i>, <b>85</b>, 5350&#x2013;5354.</p>
</aside>
<p class="indent">A reasonable starting point for the bond-stretch and angle-bend force constants would be a consensus value from all those that are available in the spectroscopic literature; standard equilibrium values for bond lengths and angles must also be taken. For dihedral angles it should be remembered that there is an additional contribution from the non-bonded energy terms to the rotational potential. This must be subtracted before fitting <i>V</i><sub>n</sub> values.</p>
<a id="page_43" class="page" style="width:70%;">Page 43, Molecular mechanics</a>
<p class="indent">Finding suitable values for van der Waals parameters presents one of the greatest problems in force field development. Although the close-packed geometry of a crystal would appear to provide details about interatomic distances, a simple deconvolution into atomic contributions is not easy; the close approach of hydrogen in an alkane crystal is mediated not just by H&#x00B7;&#x00B7;H interactions but by C&#x00B7;&#x00B7;C and C&#x00B7;&#x00B7;H pairs. The resultant intermolecular arrangement is a balance over all the interactions at short range. Using heat of sublimation data, however, the crystal energetics can be calculated as a test of the parameters. Typically, however, the van der Waals radii are used as &#x2018;soft&#x2019; parameters, that is to say, the exact values have less influence upon the final geometry than the high force constant bond-stretch and angle-bend terms. Therefore, these parameters can be used to fine-tune the potential.</p>
<p class="indent">The electrostatic interaction is unusual in that the charge density will be different for a given atom type across a range of compounds. One must either assign generic values to an atom type and make the assumption that an atom&#x2019;s contribution to the overall electrostatic energy is modulated by the other charges, or one can be consistent as to which method is used to calculate starting charges in the parameterization. Only charges calculated by this method will be compatible with the given force field.</p>
<p class="indent">Unless dealing with near ionic systems, the charges on a molecule will have less influence on the final geometry (since the electrostatic force falls off as <i>r</i><sup>&#x2212;2</sup>) than on the energy of a system. This allows one to think in terms of molecular charge distributions rather than absolute values. In some applications (free energy calculations &#x2013; <a href="Chapter_04.xhtml#ch04">Chapter 4</a>; molecular similarity &#x2013; <a href="Chapter_06.xhtml#ch06">Chapter 6</a>) vast improvements have been found when using better quality charge distributions.</p>
<p class="indent">The charges themselves can be calculated by a number of methods. Empirical charge schemes, which have usually been parameterized to give close agreement with experimental dipole moment values, provide a fast way of generating charges. These are certainly suitable for structural calculations and large systems. Some force fields have been parameterized using charges obtained from molecular electrostatic potentials (see <a href="Chapter_02.xhtml#ch02">Chapter 2</a>) and this procedure should be followed when applying the program to unknown molecules. Although there can be a tendency to use &#x2018;the best possible charges&#x2019; one must always bear in mind how crucial the absolute value will be to the application. There is little point in wasting computer time on expensive <i>ab initio</i> calculations when all one wishes to do is tidy up the stereochemistry of a model structure!</p>
<p class="indent">A different approach to generating non-bonded parameters is to fit them to data on liquid properties; the Monte Carlo method can be used for this (<a href="Chapter_04.xhtml#ch04">Chapter 4</a>). This method has been used to derive parameters for a wide range of molecular liquids indicating that it is a reliable procedure.</p>
</section>
<section epub:type="chapter" id="sec_3.5">
<h2 class="h2" style="margin-top:2em;">3.5<span class="space">&#160;</span>Conformational analysis</h2>
<p class="noindent">One of the most useful aspects of molecular mechanics calculations is that they allow rapid determination of molecular energies. This makes them very <a id="page_44" class="page">Page 44, Molecular mechanics</a>suitable for problems of conformational analysis. Since the energies calculated are relative, in the sense that they depend entirely on the connectivity of the molecule, they cannot be compared between molecules. However, when investigating conformational space this does not arise; only internal coordinates will be changed, not connectivities.</p>
<p class="indent">The simplest way to carry out conformational analysis is to derive the complete energy surface which results from changing a particular rotational variable. Making the approximation that only conformations close to the maxima and minima of the rotational potential will be observed, rotations about a saturated C-C bond can be reduced to six points. For a small molecule with, say, three rotatable bonds this does not present much of a problem as only 6<sup>3</sup> (216) conformations will be generated. If a larger molecule, containing six rotatable bonds, is of interest the number of conformations increases dramatically to 6<sup>6</sup> (46,656); and this is still a very small molecule. Obviously this kind of detailed grid scan must be modified for general use. Also, if more than two variables are used it is difficult to visualise the energy surface being mapped out.</p>
<p class="indent">Most of the solutions to the combinatorial problem of conformational search rely on methods to filter out poor conformations at as early a stage as possible. Reducing the number of values per rotatable bond is an obvious answer but immediately it should be recognised that one runs the risk of overlooking potentially interesting structures. In the case of amino acids, each residue to be calculated can be considered a pair of interdependent variables, with only certain minima from the conformational energy map (Ramachandran map) accessible. By reducing the number of pairs to either minima, or minima within a threshold of the global minimum, one can reduce interesting conformational space to a very few points, of the order of 5&#x2013;10 per residue. Similar restrictions can be applied to any pair of dihedral angles. A conformational search procedure can then proceed by considering combinations of the minima along the given chain.</p>
<aside class="abc" style="margin-top:-11em;" epub:type="sidebar">
<figure class="fig1" id="fig3_8">
<img src="../images/fig3_8.jpg" alt="images"/>
</figure>
<p class="fcaption1"><b>Fig. 3.8</b>&#x00A0;&#x00A0;Ring closure criteria for filtering out poor conformations during tree-searches: d1 must be less than d2 to continue the search.</p>
</aside>
<p class="indent">A second method of increasing the efficiency of a conformational search is to use a tree-search. Here, the search starts out as a complete grid search but as individual conformations are being generated checks are carried out to eliminate unsuitable structures before completion. Typical tests would include checking for adverse non-bonded contacts. Since many large systems contain cyclic regions, ring closure is a particularly good criterion. As a conformation is being generated it should be possible to tell whether it will ever be capable of cyclizing, based upon the maximum length of a unit in the chain (<a href="#fig3_8">Fig. 3.8</a>).</p>
<p class="indent">Usually the conformations generated by any of the above methods will have rigid geometries. Hence, minimization will be required to produce more realistic structures. If only minima are required then one can proceed as in <a href="#sec_3.3">Section 3.3</a>. If, however, one is interested in mapping out a complete surface, and barrier heights and interconversion pathways are of interest, means must be found to hold dihedrals at a particular value while minimizing all other variables. The simplest way to do this is to modify the rotational potential of the fixed dihedral by applying an offset <i>c</i><sub>2</sub> to the minimum value and using a <a id="page_45" class="page">Page 45, Molecular mechanics</a>very large rotational barrier constant <i>c</i><sub>1</sub></p>
<p class="fig1a" id="eq3.25"><math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics><mrow><mi>E</mi><mo>=</mo><msub><mi>c</mi><mn>1</mn></msub><mo stretchy='false'>[</mo><mn>1</mn><mo>+</mo><mi>c</mi><mi>o</mi><mi>s</mi><mn>3</mn><mo stretchy='false'>(</mo><mtext>&#x03C9;</mtext><mo>+</mo><msub><mi>c</mi><mn>2</mn></msub><mo stretchy='false'>)</mo><mo stretchy='false'>]</mo><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x0009;</mtext><mtext>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</mtext><mo stretchy='false'>(</mo><mn>3.25</mn><mo stretchy='false'>)</mo></mrow>
</semantics></math></p>
<p class="noindent">Following minimization the energy must be recalculated using the correct rotational potential. Great care must be taken when applying this method, especially when investigating cyclic molecules as the pathway across a surface may depend upon the starting point and the location of other stationary points on the energy surface.</p>
<p class="indent">Having obtained a potential energy surface, or conformational reaction coordinate, by one of the above methods, it is tempting to place an interpretation on the different contributions to the barrier height etc. This must be approached cautiously as it should be remembered that only features such as total energy, geometry and vibrational frequencies can be considered to have any physical meaning.</p>
<p class="indent">In the next chapter we will see that Monte Carlo and molecular dynamics methods, which allow molecules to traverse energy barriers, are more useful for larger systems.</p>
</section>
<section epub:type="chapter" id="sec_3.6">
<h2 class="h2">3.6<span class="space">&#160;</span>Summary</h2>
<p class="noindent">Force field methods of the type outlined in this chapter are finding increasing application in many areas of structural chemistry. The principal advantage of these methods is that classically based potential energy functions are less computationally expensive than quantum mechanical methods, allowing systems of the order of thousands of atoms to be considered. A large body of data now exists validating the functional forms and the variable parameters used so that, as long as one is aware of the limitations associated with a given force field, reliable results may be obtained. Many of the older force fields will be valid only for structures while thermodynamic data can be calculated from second generation force fields such as MM2. If one wants to know more about vibrational frequencies, a force field containing cross terms in the energy function must be applied. Typically, this type of force field will be more reliable between stationary points on the energy surface.</p>
<p class="indent">Minimization of structures is usually required to remove strain from poorly defined geometries. When far from a minimum, simple gradient techniques, and a less complex force field expression are the methods of choice. But, as one approaches the minimum, more sophisticated methods such as conjugate gradients are recommended: these converge much more quickly. It is also important that the parameters used are consistent with the rest of the force field. Since the parameters arise from a fitting procedure they can have little physical significance, A &#x2018;mix and match&#x2019; approach is to be avoided. Conformational search procedures often utilize molecular mechanics calculations but one must be careful that the methods used do not introduce bias into the calculation otherwise a true representation of the energy surface will not be obtained, or low energy conformers will be omitted.</p>
</section>
</section>
</body>
</html>